Origin: upstream https://github.com/nginx/nginx/commit/6dfbc8b1c2116f362bb871efebbf9df576738e89
Description: CVE-2019-9516, also known as 0-Length Headers Leak
  The attacker sends a stream of headers with a 0-length header name and 0-length header value,
  optionally Huffman encoded into 1-byte or greater headers. Some implementations allocate memory
  for these headers and keep the allocation alive until the session dies.
  This can consume excess memory, potentially leading to a denial of service.
--- a/src/http/v2/ngx_http_v2.c
+++ b/src/http/v2/ngx_http_v2.c
@@ -1550,6 +1550,14 @@ ngx_http_v2_state_process_header(ngx_htt
         header->name.len = h2c->state.field_end - h2c->state.field_start;
         header->name.data = h2c->state.field_start;
 
+        if (header->name.len == 0) {
+            ngx_log_error(NGX_LOG_INFO, h2c->connection->log, 0,
+                          "client sent zero header name length");
+
+            return ngx_http_v2_connection_error(h2c,
+                                                NGX_HTTP_V2_PROTOCOL_ERROR);
+        }
+
         return ngx_http_v2_state_field_len(h2c, pos, end);
     }
 
@@ -3248,10 +3256,6 @@ ngx_http_v2_validate_header(ngx_http_req
     ngx_uint_t                 i;
     ngx_http_core_srv_conf_t  *cscf;
 
-    if (header->name.len == 0) {
-        return NGX_ERROR;
-    }
-
     r->invalid_header = 0;
 
     cscf = ngx_http_get_module_srv_conf(r, ngx_http_core_module);
